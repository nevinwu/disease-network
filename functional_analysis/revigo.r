# A plotting R script produced by the Revigo server at http://revigo.irb.hr/
# If you found Revigo useful in your work, please cite the following reference:
# Supek F et al. 'REVIGO summarizes and visualizes long lists of Gene Ontology
# terms' PLoS ONE 2011. doi:10.1371/journal.pone.0021800

# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( 'ggplot2' );
library( ggplot2 );

# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( 'scales' );
library( scales );

# for text labels
# library(ggrepel);
pacman::p_load(ggpp)

# --------------------------------------------------------------------------
# Here is your data from Revigo. Scroll down for plot configuration options.

revigo.names <- c('term_ID','description','frequency','plot_X','plot_Y','Tamaño','Significatividad','uniqueness','dispensability');
revigo.data <- rbind(c('GO:0008152','metabolic process',43.8181920967833,6.35063169646454,-1.07253683828995,3.88941376404271,-1.56052519668322,1,0),
c('GO:0009987','cellular process',85.1263497088586,6.89755659694719,-3.51368280145417,4.17779613329222,-4.736600668666,1,0),
c('GO:0016032','viral process',1.43026739781785,6.23896869916661,-2.43691897906519,2.40483371661994,-1.31877685860483,1,0),
c('GO:0023052','signaling',28.4979365707502,7.60488271244422,-0.44001846312364,3.70260284134043,-2.131173419441,1,0),
c('GO:0043009','chordate embryonic development',3.41455141613432,3.40708045604894,-6.18972347334019,2.78175537465247,-1.67904406309902,0.930128480531205,0),
c('GO:0044419','biological process involved in interspecies interaction between organisms',8.5363785403358,4.93486951219096,0.566855925907863,3.17926446433903,-5.23892204584552,1,0),
c('GO:0051098','regulation of binding',2.04081632653061,-3.10104135166082,-6.61103236044664,2.55870857053317,-4.32738499283701,0.875650710543766,0),
c('GO:0051259','protein complex oligomerization',1.33416247385381,4.51855144636661,4.64243539159967,2.3747483460101,-3.79841171892648,0.967456350308767,0),
c('GO:0051704','multi-organism process',5.82282774605687,2.9649394063594,1.03638282946931,3.01325866528352,-2.09652474759162,1,0),
c('GO:0065007','biological regulation',69.1503194075414,2.90434086174255,2.92383734068558,4.08753297573409,-7.71233260872587,1,0),
c('GO:0022406','membrane docking',0.480524619820227,7.58042062212159,0.638471344261954,1.93449845124357,-1.43612751403828,0.996695382416432,0.00496153),
c('GO:0016071','mRNA metabolic process',3.15450279834926,0.361321478146642,6.86911761407107,2.74741180788642,-3.7183758485598,0.912728409543593,0.0061626),
c('GO:0008283','cell population proliferation',2.71920402510034,-0.31151920904803,-8.05490870695501,2.68304703823885,-1.58678408464609,0.995828830765952,0.00678402),
c('GO:0006974','cellular response to DNA damage stimulus',4.03075357566849,-4.64335732848679,3.56749582213486,2.85369821177617,-2.66348022958958,0.938460022048936,0.00718451),
c('GO:0006886','intracellular protein transport',3.87246311266889,6.86434514828044,2.44610470208773,2.83632411570675,-1.85204556906918,0.944464210164252,0.00741248),
c('GO:0008219','cell death',5.52320651252191,4.8915003404471,-1.38749998187655,2.9903388547876,-2.97309919110974,0.995320683038633,0.00784342),
c('GO:0007049','cell cycle',6.87998190966137,7.51197391672231,-1.51903386390826,3.08564728829686,-1.51310217993331,0.995135771391277,0.00859594),
c('GO:0051881','regulation of mitochondrial membrane potential',0.412685849963254,-0.21693897972229,-6.60303493837558,1.86923171973098,-1.66883599204864,0.95886466931449,0.0242592),
c('GO:0010629','negative regulation of gene expression',4.90135112216632,-5.71240391530507,-2.92432742658812,2.93851972517649,-3.68558498658633,0.788674052786873,0.03294997),
c('GO:0043065','positive regulation of apoptotic process',2.8209621798858,-1.72232471441886,-1.72884322657994,2.69897000433602,-3.17380205662193,0.864093223800511,0.04535134),
c('GO:0040008','regulation of growth',3.6406806489909,6.41830348243298,0.297785158228224,2.80955971463527,-1.5021722639165,0.94879392681648,0.04717934),
c('GO:0030155','regulation of cell adhesion',4.12120526881113,7.29067048250768,-2.57697233687028,2.86332286012046,-1.36692561815051,0.942648003873482,0.05192851),
c('GO:0050794','regulation of cellular process',62.5756119622364,-6.40749934360111,0.51569976500909,4.04414762087872,-8.43758816705027,0.899049764929701,0.08568974),
c('GO:0045595','regulation of cell differentiation',8.37243484651478,4.40545559215611,2.13705918952135,3.17084820364331,-1.42164735848964,0.934786447209491,0.10124785),
c('GO:0065009','regulation of molecular function',17.2536604669569,-0.17492419736566,2.54625423866341,3.48472680429866,-5.36808971654159,0.944789753283058,0.10224947),
c('GO:0010941','regulation of cell death',8.91514500537057,0.650785312643909,-8.00957143292539,3.1981069988734,-6.59825491776294,0.933977344489693,0.1034511),
c('GO:0042127','regulation of cell population proliferation',9.24868562383402,3.55161842794706,-0.597354782661318,3.21404867941194,-2.77525980993946,0.933494163952713,0.10478459),
c('GO:0010212','response to ionizing radiation',0.831024930747922,-2.62108056614246,3.52211641080161,2.17026171539496,-1.3829996588791,0.978035881906172,0.10900701),
c('GO:0050793','regulation of developmental process',13.2511730453954,1.4443199326013,2.09134778928681,3.3701428470511,-1.54475912212904,0.934546417488953,0.11991827),
c('GO:0032879','regulation of localization',15.1110859856408,2.18376828332589,-1.33843042306773,3.42716140292597,-1.61339403461752,0.932601830498828,0.1265963),
c('GO:0002922','positive regulation of humoral immune response',0.124371078071118,0.120724804388036,-1.12684823859859,1.36172783601759,-1.56052519668322,0.937161005955325,0.13903322),
c('GO:0043687','post-translational protein modification',0.192209847928091,1.53336456062525,5.71213724931283,1.54406804435028,-1.84930494885729,0.95104832834093,0.16139435),
c('GO:0097193','intrinsic apoptotic signaling pathway',0.819718469105093,-5.24684580046448,5.13140763820732,2.16435285578444,-2.4764095951708,0.900289650151493,0.16442414),
c('GO:0014911','positive regulation of smooth muscle cell migration',0.214822771213749,-1.72990561130232,-0.313674651465065,1.5910646070265,-1.80098572906538,0.926837540899621,0.16468205),
c('GO:0034332','adherens junction organization',0.243088925320821,5.45576509129609,4.52301585027352,1.64345267648619,-1.56052519668322,0.975534727769945,0.16508349),
c('GO:0005977','glycogen metabolic process',0.271355079427893,1.66184168744398,6.78636326218432,1.69019608002851,-1.67958366254383,0.934473927730515,0.17027134),
c('GO:0048519','negative regulation of biological process',28.9219288823563,-7.26625477856027,1.92991030992502,3.70901541697212,-8.43758816705027,0.920783552275536,0.17467422),
c('GO:0019216','regulation of lipid metabolic process',1.77511447792413,-5.92920139142775,-4.45863409641246,2.4983105537896,-1.37919791290966,0.862054105282753,0.17604608),
c('GO:0048518','positive regulation of biological process',33.9646107750579,-7.49399106688855,1.00369568614789,3.77880220401324,-7.36736052457193,0.917114664138282,0.19280197),
c('GO:0032870','cellular response to hormone stimulus',2.69093787099327,-5.59796546995279,3.70041007884729,2.67851837904011,-2.37585203005811,0.930908220398024,0.19305498),
c('GO:0030522','intracellular receptor signaling pathway',0.785799084176607,-5.81860033623925,4.5300141958762,2.14612803567824,-1.81132457703017,0.92253672097983,0.20179644),
c('GO:0019222','regulation of metabolic process',37.2265249590141,-7.44227645907253,0.324303081152845,3.81862172637589,-6.10661001554888,0.914849067873787,0.20493725),
c('GO:0051716','cellular response to stimulus',35.8188704844819,-4.30021425234117,4.81264466694433,3.80188370712524,-5.2938798902973,0.954656022356387,0.20581307),
c('GO:0061024','membrane organization',4.37560065577478,4.50362472105154,5.42275534573147,2.88930170250631,-1.61978875828839,0.970688424225355,0.22916529),
c('GO:0009719','response to endogenous stimulus',7.52445022330262,-4.10673740451694,5.59061310456572,3.12450422483428,-1.5021722639165,0.970060608536562,0.24136365),
c('GO:0014706','striated muscle tissue development',1.61117078410312,4.69684661253041,-5.12034502015193,2.45636603312904,-1.6220020521381,0.946426040630305,0.24342168),
c('GO:0050789','regulation of biological process',65.1534852168014,-6.81369473056442,1.13354124341615,4.06167861524534,-8.23149509295142,0.91851204897203,0.25367413),
c('GO:0051340','regulation of ligase activity',0.0678387698569733,-2.511489126318,-7.04431162118792,1.11394335230684,-1.60129630488692,0.904326876314724,0.25992569),
c('GO:0061061','muscle structure development',2.65701848606479,4.21993565447335,-4.7872481309068,2.6730209071289,-1.67759461893235,0.948360656378216,0.26080477),
c('GO:0048871','multicellular organismal homeostasis',1.93905817174515,0.902179928789542,-6.0807449433381,2.53655844257153,-1.56997334548999,0.924573116300506,0.26465608),
c('GO:0035556','intracellular signal transduction',8.21979761433659,-4.99907941884724,4.59538667331589,3.16286299332193,-3.60679344543663,0.890524676548897,0.26666894),
c('GO:0030098','lymphocyte differentiation',1.39634801288937,2.94050312793428,-5.37954048452967,2.39445168082622,-1.63591825858893,0.938434806088661,0.26867277),
c('GO:0043161','proteasome-mediated ubiquitin-dependent protein catabolic process',1.69031601560292,0.911259902643446,6.22453017685678,2.47712125471966,-1.56052519668322,0.93333749728179,0.2692618),
c('GO:0016925','protein sumoylation',0.20351630957092,1.74786886149781,6.17239105493065,1.56820172406699,-1.3829996588791,0.950751821194652,0.27075931),
c('GO:0008285','negative regulation of cell population proliferation',3.92334219006162,-1.07813776986915,-3.18336910892699,2.84198480459011,-2.11784559536577,0.895511160220078,0.28199214),
c('GO:0009966','regulation of signal transduction',15.9647238396744,0.528158820726582,-0.072679872731986,3.45101845215546,-1.71964930695399,0.923164040444559,0.28587832),
c('GO:0006892','post-Golgi vesicle-mediated transport',0.554016620498615,6.86448025797576,2.08515879083519,1.99563519459755,-1.6874629968927,0.973211958886759,0.28842875),
c('GO:0048522','positive regulation of cellular process',31.251059980779,-3.5493653001498,-0.769791708960795,3.74264658993874,-7.42341680244783,0.852978748402307,0.30143832),
c('GO:0031323','regulation of cellular metabolic process',33.501045847702,-5.89636135974953,-2.25592498286653,3.77283492723902,-6.10905389744959,0.774947820663388,0.30190172),
c('GO:0035295','tube development',4.76567358245237,3.77540923700921,-5.95587280331166,2.92634244662566,-1.66883599204864,0.936353022832849,0.32003928),
c('GO:0044085','cellular component biogenesis',14.0878512069648,4.68418588433055,5.0793816573004,3.39672227850377,-4.05338073076187,0.964899318828492,0.32013918),
c('GO:0044260','cellular macromolecule metabolic process',25.0946916162587,-0.0444331028693966,6.44421940446268,3.64738297011462,-7.27125674528375,0.912947188489427,0.32388841),
c('GO:0051101','regulation of DNA binding',0.667081236926904,-3.08342371840919,-6.86327767689708,2.07554696139253,-2.49489073869641,0.879099869322287,0.32666839),
c('GO:0032703','negative regulation of interleukin-2 production',0.146984001356775,-6.7852662308995,-2.40215298877834,1.43136376415899,-1.56052519668322,0.864971481878788,0.33388902),
c('GO:0051641','cellular localization',12.7254225790039,6.69348437707778,2.74068098341682,3.35256838617931,-2.90243036056863,0.96241950957904,0.33486469),
c('GO:0043433','negative regulation of DNA-binding transcription factor activity',0.921476623890554,-4.26346696406961,-5.15618756518485,2.2148438480477,-2.21196604045708,0.766748900441587,0.33897031),
c('GO:0051174','regulation of phosphorus metabolic process',7.72231330205212,-6.05485873180319,-3.83938880686125,3.13576851456782,-2.37111064238516,0.82527176491858,0.33945537),
c('GO:0010952','positive regulation of peptidase activity',1.10803324099723,-3.73062219486192,-4.69461744860087,2.29446622616159,-2.73506417821731,0.722311625606376,0.34641504),
c('GO:0007010','cytoskeleton organization',6.64819944598338,4.8768621925757,5.29874723568848,3.07077646284343,-2.06329026604833,0.968543725449468,0.34881057),
c('GO:0051270','regulation of cellular component movement',5.73237605291424,-1.11103555671609,0.848195960852202,3.00646604224923,-1.36846491698126,0.934216214138755,0.35639946),
c('GO:0043933','protein-containing complex subunit organization',7.54140991576686,5.00214116246672,4.9642927115374,3.12548126570059,-2.86331113432774,0.967837037136736,0.35848622),
c('GO:0034641','cellular nitrogen compound metabolic process',17.9094352422409,-0.420891940814014,6.79480346908379,3.5009222391903,-3.39397352534466,0.931361351171382,0.35961527),
c('GO:0048255','mRNA stabilization',0.293968002713551,-4.17441408212792,-3.3399098845562,1.72427586960079,-1.6874629968927,0.798158484682309,0.36005423),
c('GO:0050747','positive regulation of lipoprotein metabolic process',0.0282661541070722,-3.51741721228738,-3.13020110454444,0.778151250383644,-1.49533887800551,0.850833908311476,0.36274119),
c('GO:0048856','anatomical structure development',28.0795974899655,4.05257973575358,-5.48297280846336,3.69618158716852,-1.81496807956723,0.92782883061275,0.37063825),
c('GO:0007507','heart development',3.00751879699248,3.08832572381478,-5.71149175140567,2.72672720902657,-1.401570643809,0.936961865470433,0.37494955),
c('GO:0051090','regulation of DNA-binding transcription factor activity',2.35174402170841,-4.40390040856037,-4.91209766150678,2.62013605497376,-1.95260829779956,0.753385950645824,0.38053012),
c('GO:0060316','positive regulation of ryanodine-sensitive calcium-release channel activity',0.0452258465713155,-2.00020967339696,-5.48048599293084,0.954242509439325,-1.49533887800551,0.858863980716607,0.38303904),
c('GO:0009790','embryo development',5.50624682005766,3.55818675596826,-5.77639654977395,2.98900461569854,-1.63408167782366,0.934800336299988,0.38347857),
c('GO:0007417','central nervous system development',5.57408558991464,3.44109980706199,-5.197529621857,2.99431715266964,-1.50027168884983,0.933145179420341,0.38460812),
c('GO:0048732','gland development',2.31217140595851,3.02251109744566,-6.00691427584613,2.61278385671974,-1.36281057785124,0.93936035481831,0.40095645),
c('GO:0048523','negative regulation of cellular process',26.6719430154333,-6.65214524017689,-0.774817350645901,3.67384997734295,-8.34913903132845,0.853026148516832,0.40660785),
c('GO:0051246','regulation of protein metabolic process',14.2178755158573,-5.70543502621372,-3.65445998567291,3.40071063677323,-2.21347571932505,0.795197570460521,0.40751742),
c('GO:0070887','cellular response to chemical stimulus',14.3309401322856,-5.024982579955,4.0950466026084,3.40414924920969,-1.61843370420343,0.937521745132472,0.41219322),
c('GO:0043170','macromolecule metabolic process',31.7315846005992,-0.613612724678111,6.28856928488276,3.74927240829842,-5.54888931810253,0.934319159795789,0.41292626),
c('GO:0043619','regulation of transcription from RNA polymerase II promoter in response to oxidative stress',0.0621855390355588,-4.90724494776915,0.196707234140129,1.07918124604762,-2.03211520181267,0.833014309684047,0.42618198),
c('GO:0051351','positive regulation of ligase activity',0.0565323082141444,-2.34869333787371,-6.63501953257506,1.04139268515823,-1.56052519668322,0.890679174183721,0.42822334),
c('GO:0010467','gene expression',10.3510656340098,0.0684511478839028,6.02414824709223,3.26292546933183,-2.06474975938836,0.93264711296581,0.4293132),
c('GO:0033036','macromolecule localization',12.9119791961106,6.53809622507449,2.55061268115729,3.35888620440587,-2.4089799382817,0.967218909571577,0.43301671),
c('GO:0009888','tissue development',8.97167731358471,4.27627061463125,-5.56532116377265,3.20085049809108,-1.89571779290556,0.936608983207405,0.43433398),
c('GO:0044237','cellular metabolic process',39.6687206738651,-0.834440149305897,6.6388510633052,3.84621336387939,-3.47140464230593,0.93113883269699,0.44735906),
c('GO:0051338','regulation of transferase activity',4.90135112216632,-2.82908213717067,-6.59782226339827,2.93851972517649,-2.35280291639898,0.848088593823839,0.4600287),
c('GO:0007165','signal transduction',26.558878399005,-5.24392916573952,3.27765217708741,3.67200544502295,-2.34964390078369,0.862295293891559,0.4693995),
c('GO:0009653','anatomical structure morphogenesis',11.9565831872915,4.05162209561128,-5.2331392344698,3.32551566336315,-1.95241364292565,0.933029517423084,0.47108832),
c('GO:0007399','nervous system development',12.2109785742552,3.5328413342026,-5.48737493111764,3.33465476688324,-1.31211447515129,0.923003839583484,0.47402877),
c('GO:0006807','nitrogen compound metabolic process',35.9319351009102,-1.02933154219505,6.5864726411426,3.80325221143046,-2.66038957837444,0.937745743806071,0.47590559),
c('GO:0033554','cellular response to stress',8.48549946294307,-4.61679126702422,3.95951547927091,3.17666993266815,-3.60679344543663,0.943542435755425,0.47963796),
c('GO:0043412','macromolecule modification',16.0721352252812,0.142475684384618,6.36058498895527,3.45392959205773,-1.61843370420343,0.9261205364549,0.48814861),
c('GO:0009889','regulation of biosynthetic process',23.5683192944768,-6.16023810550967,-2.94625704669933,3.62013605497376,-3.16157912065911,0.796924734213636,0.4886407),
c('GO:0006355','regulation of transcription, DNA-templated',19.192718638702,-5.53225651947723,-3.1323385472602,3.53096768157191,-3.5002304642316,0.73384152943888,0.49383124),
c('GO:0031325','positive regulation of cellular metabolic process',17.8472497032054,-4.63692134828723,-2.6901805753264,3.49941212567228,-5.32303218570524,0.743951990985551,0.49409268),
c('GO:0044238','primary metabolic process',38.8263892814744,-0.904717713738315,6.37513878864451,3.83689351637643,-2.7572350222479,0.936342685600586,0.49561512));

one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != 'null' & one.data$plot_Y != 'null'), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$Tamaño <- as.numeric( as.character(one.data$Tamaño) );
one.data$Significatividad <- as.numeric( as.character(one.data$Significatividad) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
# head(one.data);

###############################################################################
# MODIFY FOR LABELS:
labels = c('chordate embryonic development', 'regulation of cellular process',
           'regulation of cell death', 'biological regulation')

`%!in%` <- Negate(`%in%`)
#one.data[,'description']%!in%labels
one.data[one.data[,'description']%!in%labels,'description'] = ''

# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below

p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = Significatividad, size = Tamaño), alpha = I(0.6) ) + scale_size_area();
p1 <- p1 + scale_colour_gradientn( colours = c('darkblue', 'lightblue1'), limits = c( min(one.data$Significatividad), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = Tamaño), shape = 21, fill = 'transparent', colour = I (alpha ('black', 0.6) )) + scale_size_area();
p1 <- p1 + scale_size( range=c(1, 10)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text_linked( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha('black', 0.85)), size = 4, nudge_y = 1.8 );
p1 <- p1 + labs (y = '', x = '');
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);

# dev.off()
# --------------------------------------------------------------------------
# Output the plot to screen

p1;

# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).

# ggsave('/path_to_your_file/revigo-plot.pdf');

